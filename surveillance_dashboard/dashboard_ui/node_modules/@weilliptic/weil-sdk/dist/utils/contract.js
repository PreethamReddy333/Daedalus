import { bytesToHex, hexToBytes } from '@noble/hashes/utils.js';
import base32Decode from 'base32-decode';
import { sha256 } from '@noble/hashes/sha2.js';
import base32Encode from 'base32-encode';
import { numberToBytes } from './numberToBytes.js';
export const decodeContractAddress = (contractAddress) => {
    const entry = base32Decode(contractAddress.toUpperCase(), 'RFC4648');
    const view = new DataView(entry);
    const podCounter = view.getUint32(0, false);
    return {
        contractAddress: bytesToHex(new Uint8Array(view.buffer.slice(8))),
        counter: podCounter,
    };
};
export const createContractAddress = (publicKey, nonce, podCounter) => {
    let toBeHashed = new Uint8Array([
        ...numberToBytes(nonce),
        ...hexToBytes(publicKey),
    ]);
    const contractAddress = sha256(toBeHashed).slice(0, 32);
    const buffer = new ArrayBuffer(4 + contractAddress.length);
    const view = new DataView(buffer);
    view.setUint32(0, podCounter);
    for (let i = 0; i < contractAddress.length; i++) {
        view.setUint8(4 + i, contractAddress[i]);
    }
    const uint8Array = new Uint8Array(buffer);
    return base32Encode(uint8Array, 'RFC4648', { padding: false }).toLowerCase();
};
//# sourceMappingURL=contract.js.map